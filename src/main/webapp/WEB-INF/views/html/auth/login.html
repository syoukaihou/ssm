<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>login</title>
    <script type="text/javascript">
        var path="";
    </script>
    <link rel="stylesheet" href="/resources/bootstrap-3.3.7-dist/css/bootstrap.css">
    <script type="text/javascript" src="/resources/js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="/resources/bootstrap-3.3.7-dist/js/bootstrap.js"></script>
</head>
<body>

    <div>
        <label for="username">username:</label>
        <input type="text" id="username" placeholder="输入用户名"/>
    </div>

    <div>
        <label for="password">password:</label>
        <input type="password" id="password" placeholder="输入密码"/>
    </div>

    <div>
        <%-- 首次获取验证码图片，也可在此将src设为访问路径/getVerify --%>
        <img id="imgVerify" class="img-rounded" src="" alt="点击更换验证码" width="100" height="50" onclick="getVerify(this);">
        <input type="button" value="login" id="login" class="btn btn-info">
    </div>



    <script type="text/javascript">
        $(document.body).ready(function() {
            // 首次获取验证码
            $("#imgVerify").attr("src", path + "/captcha/img?" + Math.random());
        });

        // 获取验证码
        function getVerify(obj) {
            obj.src = path + "/captcha/img?" + Math.random();
        }

        $("#login").click(function(){
            var username = $("#username").val();
            var password = $("#password").val();
            $.ajax({
                url:path + "/auth/login",
                data:{"username":username,"password":password},
                type:"post",
                dataType:"json",
                async:false,
                success:function(data){
                    console.log("请求成功返回！");

                    console.log(data);
                    if(data.code == 0){
                        window.location.href=path + "/user/index";
                    }else if(data.code == 30002){
                        alert("用户名或密码错误！");
                    }

                },
                error:function(data){
                    alert(data);
                    console.log(data);
                }
            });
        });
    </script>
</body>
</html>